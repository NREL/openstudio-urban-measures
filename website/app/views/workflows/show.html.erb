<h2>Workflow</h2>

<h3 class="edit-name"><%= @workflow.id %> <% if can? :update, Workflow %><%= link_to "[ edit ]", edit_workflow_path(@workflow), class: "edit-link" %><% end %></h3>

<table class="table table-striped">
  <tr>
    <th class="col-md-2">ID</th>
    <td><%= @workflow.id.to_s %></td>
  </tr>
  <tr>
    <th>Name</th>
    <td><%= @workflow.name.to_s %></td>
  </tr>
  <tr>
    <th>Feature Type</th>
    <td><%= @workflow.feature_type %></td>
  </tr>
  <tr>
    <th>Project</th>
    <td><%= link_to @workflow.project.name, @workflow.project %></td>
  </tr>
  <% @workflow.attributes.keys.sort.each do |key| %>
    <% unless key == '_id' || key == 'project_id' || key == 'name' || key == 'feature_type' %>
      <tr>
      	<% if key == 'workflow_file' %>
      		<th>Related Zip File</th>
      		<td> <%= link_to @workflow.workflow_file.file_name, download_zipfile_workflow_path(@workflow), { data: { turbolinks: false }} %><br/></td>
  	    <% else %>
  	      <th> <%= key.humanize%></th>
        	<td><%= @workflow[key] %></td>
        <% end %>
      </tr>
    <% end %>
   <% end %>
</table>

<h3>Option Sets (<%= @workflow.option_sets.count %>)</h3>
<div class="pad-top-20 pad-bot-20">
  <%= link_to 'Create New Option Set',  new_option_set_path(workflow_id: @workflow.id, project_id: @workflow.project.id), class: "btn btn-primary" %> 
</div>

<% if @workflow.option_sets.count <= 0 %>
  <p>There are no option sets associated with this workflow.</p>
<% else %>
  <table class="tablesorter table table-striped">
    <thead>
    <tr>
      <th>ID</th>
      <th>Name</th>
      <% if can? :update, Datapoint %><th>Actions</th><% end %>
    </tr>
    </thead>
    <tbody>
    <% @workflow.option_sets.each do |opt| %>
      <tr>
        <td><%= link_to opt.id, opt %></td>
        <td><%= opt.name %></td>
        <% if can? :update, OptionSet %><td><%= link_to 'Edit', edit_option_set_path(opt) %> | <%= link_to 'Destroy', opt, method: :delete, data: { confirm: 'Are you sure?' } %></td><% end %>
      </tr>
    <% end %>
    </tbody>
  </table>
<% end %>

